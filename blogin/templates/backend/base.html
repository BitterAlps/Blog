<!DOCTYPE html>
{% extends "bootstrap/base.html" %}
{% block head %}
    <!--suppress ALL -->
    <title>{% block title %}{% endblock %} - Blogin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="{{ url_for('static', filename='jquery/jquery-3.5.1.min.js') }}"></script>

    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.png') }}" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename = 'favicon.png') }}" type="image/x-icon">

    <link rel="stylesheet" href="{{ url_for('static', filename = 'css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename = 'css/ck.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename = 'css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename = 'skeleton/jquery.skeleton.css') }}">

    <script src="{{ url_for('static', filename='skeleton/jquery.scheletrone.js') }}"></script>
    <script src="{{ url_for('static', filename='js/base.js') }}"></script>
    {% if request.cookies.get('blog_theme', 'light') == 'light' %}
        <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap4/light/' + light) }}">
        <link rel="stylesheet" href="{{ url_for('static', filename = 'css/light.css') }}">
    {% else %}
        <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap4/dark/' + dark) }}">
        <link rel="stylesheet" href="{{ url_for('static', filename = 'css/dark.css') }}">
    {% endif %}
    <script src="{{ url_for('static', filename='popper/popper.min.js') }}"></script>

    {#    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js"></script>#}
    <!--<link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">-->
    {#    <link href="https://cdn.jsdelivr.net/npm/bootstrap3@3.3.5/dist/css/bootstrap.min.css" rel="stylesheet">#}
    <script src="{{ url_for('static', filename='bootstrap-4.5.3-dist/js/bootstrap.min.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='font-awesome-4.7.0/css/font-awesome.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap4/light/flatly.bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/backend.css') }}">
    <script src="/static/bootstrap-select/js/bootstrap-select.min.js"></script>
    {{ moment.include_moment(local_js=url_for('static', filename='js/moment-with-locales.min.js')) }}
        <script src="{{ url_for('static', filename='echarts-4.9.0/echarts.min.js') }}"></script>

{% endblock %}
{% block navbar %}
    <div class="header-page">
{#    this #}
        <nav class="navbar navbar-expand-sm container">
            <!-- Brand -->
            <a class="navbar-brand text-dark" href="/backend/admin/index/">
                {% if request.cookies.get('blog_theme', 'light') == 'light' %}
                    <img src="{{ url_for('static', filename='img/logo.png') }}" alt="logo" width="104px" height="36px">
                {% else %}
                    <img src="{{ url_for('static', filename='img/logo_black.png') }}" alt="logo" width="104px"
                         height="36px">
                {% endif %}
            </a>
            <!-- Links -->
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        博客管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/admin/blog/create/">新增博客</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/admin/blog/edit/">编辑博客</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        图片管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/photo/add/">新增照片</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/photo/edit/">编辑照片</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        计划管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/plan/add/">新增计划</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/plan/edit/">编辑计划</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        用户管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/interactive/index/">用户管理</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        评论管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/interactive/blog-comment/">博客评论</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/interactive/photo-comment/">相册评论</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        时间线管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/timeline/add/">新增时间线</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/timeline/edit/">编辑时间线</a>
                    </div>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        友链管理
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="/backend/flink/add/">新增友链</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/flink/edit/">编辑友链</a>
                    </div>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbardrop" data-toggle="dropdown">
                        其他
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/config-theme/">主题配置</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/logs/">运行日志</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/backend/server-status/">服务器状态</a>
                    </div>
                </li>
            </ul>
            {% if not current_user.is_authenticated %}
                <ul class="navbar-nav f-17">
                    <li class="nav-item"><a class="nav-link nav-text" href="/auth/login/">{{ _('Login') }}</a></li>
                    <li class="nav-item"><a class="nav-link nav-text" href="/auth/register/">{{ _('Register') }}</a>
                    </li>
                </ul>
            {% else %}
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle nav-text" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                           title="{{ _('Welcome') }},{{ current_user.username }}~">
                            <img class="avatar" src="{{ current_user.avatar }}" alt={{ current_user.username }}>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right mt-0 rounded-0 border-0"
                             aria-labelledby="navbarDropdown">
                            <a class="dropdown-item pl-3 " href="/accounts/profile"><i
                                    class="fa fa-fw fa-user mr-2"></i>{{ _('Profile') }}</a>
                            {% if ntf_counts %}
                                <a href="/accounts/profile" class="dropdown-item pl-3">
                                <i class="fa fa-fw fa-bell mr-2"></i>{{ _('Notify') }}
                                <span class="badge badge-info">{{ ntf_counts }}</span>
                            {% endif %}
                            {% if current_user.role_id == 1 %}
                                <a class="dropdown-item pl-3" href="/backend/admin/index/ "><i
                                        class="fa fa-fw fa-magnet mr-2"></i>{{ _('Manage') }}</a>
                            {% endif %}
                            {% if  request.cookies.get('blog_theme', 'light') == 'light' %}
                                <a class="dropdown-item pl-3"
                                   href="{{ url_for('blog_bp.change_theme', theme_name='dark') }}"><i
                                        class="fa fa-fw fa-moon-o mr-2"></i>{{ _('Dark') }}</a>
                            {% else %}
                                <a class="dropdown-item pl-3"
                                   href="{{ url_for('blog_bp.change_theme', theme_name='light') }}"><i
                                        class="fa fa-fw fa-sun-o mr-2"></i>{{ _('Light') }}</a>
                            {% endif %}

                            </a>
                            <a class="dropdown-item pl-3" href="/auth/logout"><i
                                    class="fa fa-fw fa-sign-out mr-2"></i>{{ _('Log Out') }}</a>
                        </div>
                    </li>
                </ul>
            {% endif %}
        </nav>
    </div>
{% endblock %}
{% block content %}
{% endblock %}
{% block scripts %}
    <script>
        $('.dropdown-menu a.dropdown-toggle').on('click', function (e) {

            if (!$(this).next().hasClass('show')) {
                $(this).parents('.dropdown-menu').first().find('.show').removeClass('show');
            }

            var $subMenu = $(this).next('.dropdown-menu');

            $subMenu.toggleClass('show');

            $(this).parents('li.nav-item.dropdown.show').on('hidden.bs.dropdown', function (e) {
                $('.dropdown-submenu .show').removeClass('show');
            });

            return false;
        });
    </script>
{% endblock %}